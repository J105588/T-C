<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>利用規約同意・情報収集フォーム</title>
    <style>
        body {
            font-family: 'Hiragino Kaku Gothic ProN', 'ヒラギノ角ゴ ProN W3', Meiryo, メイリオ, Osaka, 'MS PGothic', arial, helvetica, sans-serif;
            line-height: 1.8;
            color: #333;
            background-color: #f4f4f4;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
        }

        .container {
            width: 100%;
            max-width: 700px;
            background-color: #fff;
            padding: 30px 40px;
            border-radius: 8px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
        }

        h1 {
            text-align: center;
            margin-bottom: 25px;
            color: #2c3e50;
        }

        /* --- 利用規約ボックスのスタイル --- */
        .terms-box {
            height: 300px;
            overflow-y: scroll;
            border: 1px solid #ccc;
            padding: 15px 25px; /* 横の余白を少し広げました */
            margin-bottom: 20px;
            background-color: #fafafa;
            font-size: 14px;
            line-height: 1.7; /* 行間を少し調整 */
        }
        
        /* 規約内の見出しスタイルを追加 */
        .terms-box h2 {
            font-size: 18px;
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 5px;
            margin-top: 20px;
            margin-bottom: 15px;
        }
        
        .terms-box h3 {
            font-size: 16px;
            color: #333;
            border-left: 4px solid #bdc3c7;
            padding-left: 10px;
            margin-top: 25px;
            margin-bottom: 15px;
        }

        .terms-box p {
            margin-bottom: 1em;
        }

        .terms-box strong {
            color: #c0392b; /* 強調テキストの色を少し赤系に */
        }
        /* --- スタイルここまで --- */


        .agreement-check {
            text-align: center;
            margin-bottom: 25px;
        }

        .agreement-check label {
            cursor: pointer;
            font-size: 16px;
        }

        .agreement-check input {
            margin-right: 8px;
            transform: scale(1.2);
        }

        #userInfoForm {
            display: none; /* 初期状態では非表示 */
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        .form-group input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
            font-size: 16px;
        }

        .submit-btn {
            width: 100%;
            padding: 12px;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 18px;
            font-weight: bold;
            transition: background-color 0.3s;
        }

        .submit-btn:hover {
            background-color: #2980b9;
        }
        
        .submit-btn:disabled {
            background-color: #bdc3c7;
            cursor: not-allowed;
        }

        #loading, #successMessage {
            text-align: center;
            font-size: 16px;
            font-weight: bold;
            padding: 15px;
            border-radius: 5px;
            margin-top: 20px;
        }
        
        #loading {
            display: none;
            color: #3498db;
        }
        
        #successMessage {
            display: none;
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
    </style>
</head>
<body>

    <div class="container">
        <h1>利用規約への同意</h1>

        <!-- ここから利用規約 -->
        <div class="terms-box" id="termsBox">
            <h2>工具貸出管理システム 利用規約</h2>
            <p><strong>制定日: 2025年8月12日</strong></p>
            <p>
                本利用規約（以下<strong>「本規約」</strong>といいます。）は、[あなたの名前またはチーム名]（以下<strong>「当方」</strong>といいます。）が提供する「工具貸出管理システム」（以下<strong>「本システム」</strong>といいます。）の利用に関する条件を定めるものです。本システムの利用者（以下<strong>「利用者」</strong>といいます。）は、本システムの利用を開始する前に、本規約の全文を注意深くお読みいただき、その内容に完全に同意いただく必要があります。利用者が本システムを利用した場合、本規約の全条項に同意したものとみなします。
            </p>
            <h3>第1条（総則）</h3>
            <p>1. 本規約は、利用者と当方との間の本システムの利用に関わる一切の関係に適用されるものとします。</p>
            <p>2. 当方は、利用者の承諾を得ることなく、いつでも本規約の内容を改定することができるものとします。変更後の本規約は、本システムがホストされているウェブページ上に掲載された時点から効力を生じるものとし、利用者が変更後に本システムを利用した場合、変更後の規約に同意したものとみなします。</p>
            <h3>第2条（システムの性質と利用者の自己責任）</h3>
            <p>1. 本システムは、現状有姿で提供されるものであり、当方はその機能、性能、信頼性、正確性、完全性、特定目的への適合性、セキュリティに関する欠陥、エラーやバグ、権利侵害の不存在について、明示的か黙示的かを問わず、一切の保証を行いません。</p>
            <p>2. 本システムの利用は、完全に利用者の自己責任において行われるものとします。利用者は、本システムの利用に必要なPC、ブラウザ、通信環境、セキュリティ対策等を、自らの費用と責任において整備するものとします。</p>
            <h3>第3条（データの管理と免責）</h3>
            <p>1. 本システムで扱われる全てのデータ（工具情報、貸出履歴、在庫状況等を含むがこれに限らない）は、利用者が使用するコンピュータのブラウザのローカルストレージにのみ保存されます。当方は利用者のデータを一切収集、保持、バックアップする義務を負いません。</p>
            <p>2. 利用者は、自らの責任において、入力したデータのバックアップや保全を行うものとします。</p>
            <p>3. 以下の事由により利用者のデータが消失、毀損、漏洩した場合であっても、当方は一切の責任を負いません。<br>
                a. ブラウザのキャッシュ、Cookie、サイトデータの削除<br>
                b. OSの再インストール、ブラウザのアンインストール<br>
                c. PCの故障、紛失、盗難<br>
                d. マルウェア感染、不正アクセス<br>
                e. その他、当方の責に帰すべからざる事由</p>
            <h3>第4条（禁止事項）</h3>
            <p>利用者は、本システムの利用にあたり、以下の行為を行ってはなりません。<br>
                1. 法令または公序良俗に違反する行為、またはその恐れのある行為。<br>
                2. 本システムのソースコードをリバースエンジニアリング、逆コンパイル、逆アセンブルする行為。<br>
                3. 本システムのサーバーまたはネットワークに過度な負荷をかける行為。<br>
                4. 本システムの脆弱性を意図的に利用する行為、または第三者に流布する行為。<br>
                5. 本システムを、当方が意図する利用目的と異なる目的で利用する行為。<br>
                6. 当方または第三者の知的財産権、プライバシー、名誉その他の権利または利益を侵害する行為。<br>
                7. その他、当方が不適切と合理的に判断する行為。</p>
            <h3>第5条（サービスの停止・中断・終了）</h3>
            <p>1. 当方は、以下のいずれかの事由があると判断した場合、利用者に事前に通知することなく、本システムの全部または一部の提供を永久的に停止または中断することができるものとします。<br>
                a. 本システムのメンテナンス、アップデート、または仕様変更を行う場合<br>
                b. 天災地変、火災、停電、通信障害等の不可抗力により、本システムの提供が困難となった場合<br>
                c. 本システムがホストされているサービスの障害やメンテナンス<br>
                d. その他、当方が運用上または技術上、本システムの停止・中断が必要と判断した場合</p>
            <p>2. 当方は、当方の都合により、いつでも本システムの提供を終了することができます。</p>
            <p>3. 当方は、本条に基づき当方が行った措置により利用者に生じた損害について、一切の責任を負いません。</p>
            <h3>第6条（知的財産権）</h3>
            <p>本システムに関する著作権その他一切の知的財産権は、当方に帰属します。利用者は、本規約で明示的に許諾される範囲を超えて、当方の許可なく本システムを複製、改変、翻案、頒布、公衆送信（送信可能化を含む）することはできません。</p>
            <h3>第7条（損害賠償と免責）</h3>
            <p>1. 利用者が本規約に違反したことにより当方に損害を与えた場合、当方は当該利用者に対し、その損害（弁護士費用を含む）の賠償を請求することができるものとします。</p>
            <p>2. 当方は、本システムの利用または利用不能から生じる一切の損害（直接損害、間接損害、派生損害、逸失利益、データ損失等を含むがこれらに限らない）について、たとえ事前にその可能性を通知されていた場合でも、一切の責任を負わないものとします。</p>
            <p>3. 本システムは無償で提供されるサービスであることに鑑み、いかなる場合であっても、当方が利用者に対して負う損害賠償責任の総額は、理由の如何を問わず、金0円とします。</p>
            <h3>第8条（分離可能性）</h3>
            <p>本規約のいずれかの条項またはその一部が、法令等により無効または執行不能と判断された場合であっても、本規約の残りの規定及び部分は、継続して完全に効力を有するものとします。</p>
            <h3>第9条（準拠法および管轄裁判所）</h3>
            <p>1. 本規約の解釈にあたっては、日本法を準拠法とします。</p>
            <p>2. 本システムに関して紛争が生じた場合には、訴額に応じて、当方の所在地を管轄する地方裁判所または簡易裁判所を第一審の専属的合意管轄裁判所とします。</p>
            <p>以上</p>
        </div>
        <!-- 利用規約ここまで -->

        <div class="agreement-check">
            <label>
                <input type="checkbox" id="agreementCheckbox"> 上記の利用規約に同意します
            </label>
        </div>

        <form id="userInfoForm">
            <div class="form-group">
                <label for="year">年</label>
                <input type="number" id="year" name="year" required>
            </div>
            <div class="form-group">
                <label for="class">組</label>
                <input type="number" id="class" name="class" required>
            </div>
            <div class="form-group">
                <label for="name">氏名</label>
                <input type="text" id="name" name="name" required>
            </div>
            <div class="form-group">
                <label for="email">メールアドレス</label>
                <input type="email" id="email" name="email" required>
            </div>
            <button type="submit" class="submit-btn" disabled>同意して送信する</button>
        </form>
        
        <div id="loading">送信中です...</div>
        <div id="successMessage">送信が完了しました。</div>

    </div>

    <script>
        // (JavaScript部分は変更ありません)
        const agreementCheckbox = document.getElementById('agreementCheckbox');
        const userInfoForm = document.getElementById('userInfoForm');
        const submitBtn = document.querySelector('.submit-btn');

        agreementCheckbox.addEventListener('change', () => {
            if (agreementCheckbox.checked) {
                userInfoForm.style.display = 'block';
                submitBtn.disabled = false;
            } else {
                userInfoForm.style.display = 'none';
                submitBtn.disabled = true;
            }
        });

        userInfoForm.addEventListener('submit', (e) => {
            e.preventDefault();

            const form = e.target;
            const loading = document.getElementById('loading');
            const successMessage = document.getElementById('successMessage');

            submitBtn.disabled = true;
            submitBtn.textContent = '送信中...';
            loading.style.display = 'block';
            
            // ★ Google Apps Script の WebアプリURLをここに貼り付けます
            const GAS_URL = 'https://script.google.com/macros/s/AKfycbxpUM-wR7lSPVEWza3WBOHJD8tX902sPNFW8aXGuWyGOss2vPz7qDnvvky6vffmiKjGxQ/exec';

            const formData = new FormData(form);

            fetch(GAS_URL, {
                method: "POST",
                body: formData,
                mode: "no-cors"
            })
            .then(() => {
                form.style.display = 'none';
                loading.style.display = 'none';
                successMessage.style.display = 'block';
            })
            .catch(error => {
                console.error('送信エラー:', error);
                alert('送信中にエラーが発生しました。時間をおいて再度お試しください。');
                submitBtn.disabled = false;
                submitBtn.textContent = '同意して送信する';
                loading.style.display = 'none';
            });
        });
    </script>
</body>
</html>
